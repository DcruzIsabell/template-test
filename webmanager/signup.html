<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xogo-manager</title>
    <link rel="stylesheet" href="./assets/css/output.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@latest/dist/tailwind.min.css" rel="stylesheet">
</head>
<body>
    <!--full-->
    <div class="flex flex-col">
        <!--half1-->
        <div class="flex flex-col md:flex-row w-full md:mt-0 justify-center items-center px-4 md:px-0  mt-10 md:w-1/2">
            <div class="flex flex-col py-5 w-full justify-center items-center">
                <!--logo-->
                <div class="p-5 mt-5">
                    <img src="./assets/images/xogo-l.png" class=" p-4 h-20 md:h-28">
                </div>            
                <!--micro-->
                <div class="m-6">
                    <button class="border rounded-md">
                        <img src="./assets/images/micro.png" class="h-6 m-2">
                    </button>
                </div>
                <div class="flex h-4 w-full items-center justify-center">
                    <div class="flex flex-col justify-center w-full">
                        <hr class="w-full h-full">
                    </div>
                    <span class="mx-2 text-[12px]">OR</span>
                    <div class="flex flex-col justify-center w-full">
                        <hr class="w-full h-full">
                    </div>
                </div>
                
                <div class="flex w-4/5 justify-center pt-2">
                    <div class="flex flex-col flex-1 w-full justify-start gap-5">
                        <div class="flex flex-col">
                            <p class="font-bold py-2">First Name</p>
                            <input type="text" id="fname" placeholder="Enter your first name" class="border border-black rounded py-3 px-4">
                            <p class="font-bold py-2">Last Name</p>
                            <input type="text" id="lname" placeholder="Enter your last name" class="border border-black rounded py-3 px-4">
                            <p class="font-bold py-2">Company Name</p>
                            <input type="text" id="cname" placeholder="Enter your company name" class="border border-black rounded py-3 px-4">
                            <p class="font-bold py-2">Title Name</p>
                            <input type="text" id="title" placeholder="Enter your title" class="border border-black rounded py-3 px-4">
                            <p class="font-bold py-2">Email</p>
                            <input type="email" id="email" placeholder="Enter your email" class="border border-black rounded py-3 px-4">
                            <p class="font-bold py-2">Password</p>
                            <input type="password" id="pass1" placeholder="Enter your password" class="border border-black rounded py-3 px-4">
                            <p class="font-bold py-2">Re-enter Password</p>
                            <input type="password" id="pass2" placeholder="Reenter your password" class="border border-black rounded py-3 px-4">
                        </div>
                        <div class="flex">
                            <label class="inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="sellerCheckbox" class="sr-only peer">
                                <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-xogo"></div>
                                <span class="ms-3 text-sm font-normal text-black">I am a seller</span>
                            </label>
                        </div>
                        <div id="sellerCode" class="hidden">
                            <label for="sellerNumber" class="block mb-2 text-black"><p class="font-bold py-2">Reseller Code</p></label>
                            <input type="text" id="sellerNumber" placeholder="Enter reseller code" class="border border-black rounded p-2 w-full">
                        </div>
                        <script type="text/javascript">
                            $(function () {
                                $("#sellerCheckbox").click(function () {
                                    if ($(this).is(":checked")) {
                                        $("#sellerCode").removeClass("hidden");
                                    } else {
                                        $("#sellerCode").addClass("hidden");
                                    }
                                });
                            });
                        </script>
                        <div class="flex">                        
                            <label class="inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="termsandcon" class="sr-only peer">
                                <div class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-xogo"></div>
                                <span class="ms-3 text-sm font-normal text-black">I have read and accept <a href="#" class="no-underline text-xogo">End User <br>License Agreement</a></span>
                            </label>
                        </div>
                        <div class="flex flex-col gap-4 pt-4">
                            <a href="#" id="regButton" class="bg-xogo text-white text-center rounded py-4 px-2 justify-center text-sm">Register</a>
                            <a href="index.html" class="border border-xogo rounded-md py-4 px-2 text-center text-sm">Sign Into Your Account</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--half2-->
        <div class="flex-col fixed right-0 justify-center items-center h-full w-1/2 md:object-center bg-[url('./assets/images/banner.png')] bg-no-repeat bg-cover hidden md:block">
            <div class="bg-xogo h-full w-full flex flex-col justify-center items-center p-4 bg-opacity-80">
                <span class="text-[24px] md:text-[2.5rem] font-[100] text-white text-center opacity-100">You're looking at the 
                    <span class="font-bold">easiest</span> digital signage platform on the planet.</span> 
                    <span class="text-[24px] md:text-[2.5rem] font-[100] text-white text-center opacity-100">Sets up in 3 quick steps!</span> 
                    <div class="flex justify-center mt-6">
                        <a href="index.html" class="bg-white text-md w-full rounded-lg py-2 md:py-3 px-6 text-md tracking-wide opacity-100">Sign In</a>
                    </div>
            </div>
        </div>
    </div>
</body>

<script>
    document.getElementById('regButton').onclick = function(event) {
        event.preventDefault();
        
        // Gather values
        const fname = document.getElementById('fname').value.trim();
        const lname = document.getElementById('lname').value.trim();
        const cname = document.getElementById('cname').value.trim();
        const title = document.getElementById('title').value.trim();
        const email = document.getElementById('email').value.trim();
        const pass1 = document.getElementById('pass1').value.trim();
        const pass2 = document.getElementById('pass2').value.trim();
        const sellerCheckbox = document.getElementById('sellerCheckbox').checked;
        const sellerNumber = sellerCheckbox ? document.getElementById('sellerNumber').value.trim() : "";
        const termsandcon = document.getElementById('termsandcon').checked;

        // Validate each field and show an alert immediately if an issue is found
        if (fname === '') {
            alert("First Name is required.");
            return;
        }
        if (lname === '') {
            alert("Last Name is required.");
            return;
        }
        if (cname === '') {
            alert("Company Name is required.");
            return;
        }
        if (title === '') {
            alert("Title is required.");
            return;
        }
        if (email === '') {
            alert("Email is required.");
            return;
        }
        if (pass1 === '') {
            alert("Password is required.");
            return;
        }
        if (pass1 !== pass2) {
            alert("Passwords do not match.");
            return;
        }
        if (!termsandcon) {
            alert("You must accept the license agreement.");
            return;
        }
        if (sellerCheckbox && sellerNumber === '') {
            alert("Reseller Code is required if you are a seller.");
            return;
        }
        // Proceed with form submission if all validations pass
        function hashPassword(password) {
            return CryptoJS.MD5(password).toString();
        }

        const hashedPassword = hashPassword(pass1);

        // If validation passes, you can now proceed with form submission
        const myHeaders = new Headers();
        myHeaders.append("x-api-version", "1.0");
        myHeaders.append("Content-Type", "application/json");

        const requestOptions = {
            method: "POST",
            headers: myHeaders,
            body: JSON.stringify({
                firstName: fname,
                lastName: lname,
                companyName: cname,
                title: title,
                email: email,
                hashedPassword: hashedPassword, // Send the hashed password
                resellerCode: sellerNumber,
                isEULAAccepted: termsandcon // Include this field
            }),
            redirect: "follow"
        };

        fetch("https://api2-staging.xogo.io/v2/api/users", requestOptions)
        .then(response => response.json())
        .then(result => {
            console.log(result);
             if (email == result.user.email)
             {
                alert("Email already exist");
             }
            else
            {
                
            }
        })
        .catch(error => {
            console.error("Error:", error);
            alert("An error occurred during registration.");
        });

    };
</script>
</html>
